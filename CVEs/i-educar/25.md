# Multiples Stored Cross-Site Scripting (XSS) in `educar_calendario_anotacao_cad.php` 

### Summary

<p align="justify">Multiples Stored Cross-Site Scripting (XSS) vulnerability was identified in the <code>/intranet/educar_calendario_anotacao_cad.php</code> endpoint of the i-Educar application. This vulnerability allows attackers to inject malicious scripts into the <code>nm_anotacao</code> and <code>descricao</code> parameters. The injected scripts are stored on the server and executed automatically whenever the affected page is accessed by users, posing a significant security risk.</p>

---

### Details

Vulnerable Endpoint: `/intranet/educar_calendario_anotacao_cad.php`

Parameter: `nm_anotacao`, `descricao`

Trigger Page: `/intranet/educar_calendario_anotacao_lst.php`

<p align="justify">The application fails to properly validate and sanitize user inputs in the <code>nm_anotacao</code> and <code>descricao</code> parameters. This lack of validation allows attackers to inject malicious scripts, which are then stored on the server. Whenever the affected page is accessed, the malicious payload is executed in the victim's browser, potentially compromising the user's data and system.</p>

---

### PoC

#### Step by Step:

<p align="justify">Access endpoint <code>/intranet/educar_calendario_ano_letivo_lst.php</code> (must be with no registers) and click on <code>"Novo Calend√°rio Letivo"</code> to set a new entry. Choose default options in all fields and click on <code>"Salvar"</code> and the trigger page will be activated automatically. </br></br>In trigger page select and click on any work day of the calendar, for this example was choosen <code>"August 4th, 2025"</code>. </br></br>In the new page <code>/intranet/educar_calendario_anotacao_lst.php</code> click on <code>"Nova Anota√ß√£o"</code> to set a new entry and insert the payload in first field (<code>"Anota√ß√£o"</code>) and second field (<code>"Descri√ß√£o"</code>). Click on <code>"Salvar"</code> and the trigger page will be activated automatically.</p></p>

##

#### Payload:

````javascript
"><img src=x onerror=alert('CVE-Hunters')>
````
</br>

![](/CVEs/images/storedXss94.png)

![](/CVEs/images/storedXss95.png)

![](/CVEs/images/storedXss96.png)

![](/CVEs/images/storedXss97.png)

![](/CVEs/images/storedXss98.png)

![](/CVEs/images/storedXss99.png)

![](/CVEs/images/storedXss100.png)

![](/CVEs/images/storedXss101.png)

---

### Impact

<p align="justify">
<ul>
  <li>Stealing session cookies: Attackers can use stolen session cookies to hijack a user's session and perform actions on their behalf.</li>
  <li>Downloading malware: Attackers can trick users into downloading and installing malware on their computers.</li>
  <li>Hijacking browsers: Attackers can hijack a user's browser or deliver browser-based exploits.</li>
  <li>Stealing credentials: Attackers can steal a user's credentials.</li>
  <li>Obtaining sensitive information: Attackers can obtain sensitive information stored in a user's account or in their browser.</li>
  <li>Defacing websites: Attackers can deface a website by altering its content.</li>
  <li>Misdirecting users: Attackers can change the instructions given to users who visit the target website, misdirecting their behavior.</li>
  <li>Damaging a business's reputation: Attackers can damage a business's image or spread misinformation by defacing a corporate website.</li>
</ul>
</p>

---

### Finder

*Discovered withüíú by [Karina Gante](https://karinagante.github.io/).* 

[![LinkedIn](https://skillicons.dev/icons?i=linkedin&theme=dark)](https://www.linkedin.com/in/karina-gante/)
[![GitHub](https://skillicons.dev/icons?i=github&theme=dark)](https://www.github.com/KarinaGante/)
[![gmail](https://skillicons.dev/icons?i=gmail&theme=dark)](mailto:karina.gante1@gmail.com)
[![Instagram](https://skillicons.dev/icons?i=instagram&theme=dark)](https://www.instagram.com/karinovisk02/)

##

*Official Member of [CVE-Hunters](https://www.cvehunters.com/)üèπ*